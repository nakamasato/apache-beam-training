# [1. First Apache Beam Application](https://github.com/nakamasato/apache-beam-training/tree/2a13d4bd5c5cfbc85da952565e3d3b90300c2dac)

## Step by Step
1. Update `app/build.gradle.kts`.

    ```kotlin
    /*
     * This file was generated by the Gradle 'init' task.
     *
     * This generated file contains a sample Java application project to get you started.
     * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
     * User Manual available at https://docs.gradle.org/7.5.1/userguide/building_java_projects.html
     */

    plugins {
        // Apply the application plugin to add support for building a CLI application in Java.
        application
    }

    repositories {
        // Use Maven Central for resolving dependencies.
        mavenCentral()

        maven {
            url = uri("https://packages.confluent.io/maven/")
        }
    }

    dependencies {
        // Use JUnit Jupiter for testing.
        testImplementation("org.junit.jupiter:junit-jupiter:5.8.2")

        // This dependency is used by the application.
        implementation("com.google.guava:guava:31.0.1-jre")

        // https://mvnrepository.com/artifact/org.apache.beam/beam-sdks-java-core
        implementation("org.apache.beam:beam-sdks-java-core:2.41.0")

        // https://mvnrepository.com/artifact/org.apache.beam/beam-runners-direct-java
        runtimeOnly("org.apache.beam:beam-runners-direct-java:2.41.0")

    }

    application {
        // Define the main class for the application.
        mainClass.set("apachebeamtraining.App")
    }

    tasks.named<Test>("test") {
        // Use JUnit Platform for unit tests.
        useJUnitPlatform()
    }

    if (project.hasProperty("dataflow-runner")) {
        dependencies {
            runtimeOnly("org.apache.beam:beam-runners-google-cloud-dataflow-java:2.41.0")
        }
    }

    task("execute", JavaExec::class) {
        classpath = sourceSets["main"].runtimeClasspath
        mainClass.set(System.getProperty("mainClass"))
    }
    ```

1. Create a Apache Beam pipeline in `main` function.

    ```java
    PipelineOptions options = PipelineOptionsFactory.create();
    // Create pipeline
    Pipeline p = Pipeline.create(options);
    // Read text data from Sample.txt
    PCollection<String> textData = p.apply(TextIO.read().from("Sample.txt"));
    // Write to the output file with wordcounts as a prefix
    textData.apply(TextIO.write().to("wordcounts"));
    // Run the pipeline
    p.run().waitUntilFinish();
    ```

1. Prepare `app/Sample.txt` file. (You can write anything in the file.)
1. Run

    ```
    ./gradlew run
    ```

    You'll see `wordcounts-*` files under `app` directory.
